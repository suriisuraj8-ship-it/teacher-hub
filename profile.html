<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>User Profile</title>
<style>
body {
  font-family:'Poppins',sans-serif;
  background:#000;
  color:#fff;
  margin:0;
  padding:40px 20px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}
h1 {color:#ffb347;margin-bottom:20px;text-shadow:0 0 6px #000;}
.card {
  background:#111;
  padding:30px;
  border-radius:18px;
  box-shadow:0 0 10px rgba(255,255,255,0.1);
  width:90%;
  max-width:400px;
}
label {display:block;margin-top:15px;color:#ffb347;}
input {
  width:100%;padding:10px;margin-top:6px;
  border:none;border-radius:8px;outline:none;
  font-size:16px;
}
button {
  margin-top:22px;padding:12px 20px;
  background:linear-gradient(135deg,#ff7e5f,#feb47b);
  color:#000;font-weight:700;border:none;border-radius:30px;
  cursor:pointer;width:100%;
}
button:hover {opacity:0.9;}
</style>
</head>
<body>

<h1>Your Profile</h1>
<div class="card">
  <label>Name:</label>
  <div id="userName"></div>

  <label>Email:</label>
  <div id="userEmail"></div>

  <label>Phone Number:</label>
  <input type="text" id="phone" placeholder="Enter phone number">

  <button onclick="savePhone()">Save</button>
</div>

<script>
const API_BASE = "http://localhost:5000";

function getCurrentUser(){
  try {
    return JSON.parse(localStorage.getItem("teacherHubUser"));
  } catch { return null; }
}

async function loadProfile(){
  const u = getCurrentUser();
  if(!u || !u.email){
    alert("Please log in first.");
    location.href = "login.html";
    return;
  }
  document.getElementById("userName").textContent = u.name;
  document.getElementById("userEmail").textContent = u.email;

  const res = await fetch(`${API_BASE}/get-profile/${u.email}`);
  const data = await res.json();
  if(data.success){
    document.getElementById("phone").value = data.user.phone || "";
  }
}

async function savePhone(){
  const u = getCurrentUser();
  if(!u) return alert("Please log in first.");

  const phone = document.getElementById("phone").value.trim();
  if(phone === "") return alert("Enter a valid phone number.");

  const res = await fetch(`${API_BASE}/save-profile`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({email:u.email,phone})
  });
  const data = await res.json();
  alert(data.message || "Saved!");
}

document.addEventListener("DOMContentLoaded", loadProfile);
</script>
</body>
</html>
